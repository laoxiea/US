<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<ul>
    <li>11</li>
    <li>22</li>
    <li>33</li>
</ul>
<p></p>
<script src="../js/jquery.min.js"></script>
<script src="../js/myLib.js"></script>
<script>
    $('p').html('总价：' + $('li').sum())
    $().a1();
    $().a2()
</script>
<script>
    const API_PROXY = 'https://bird.ioliu.cn/v1/?url=';
    (function () {
        var arr1 = []
//        $.ajax({
//            url: API_PROXY + "https://api.douban.com/v2/book/search?q='养殖大户科学养猪系列'",
//            method: 'get',
//            dataType: 'json',
//            success: res => {
//                console.log(res);
//                arr1 = res
//            },
//            fail: function (a) {
//                console.log(a)
//            }
//        })


//        Promise.resolve($.ajax({
//                url: API_PROXY+"https://api.douban.com/v2/book/search?q='养殖大户科学养猪系列'",
//                method: 'get',
//                dataType: 'json',
////                async: false,
//                success: res => {
//                    console.log(res);
//                    arr1 = res
//                },
//                fail: function (a) {
//                    console.log(a)
//
//                }
//            })
//        ).then(
//            res => console.log(arr1)
//        ).catch(
//            (e)=>{console.log(e)}
//            )
//        console.log(arr1)
//        return arr1

        return new Promise((resolve, reject) => {
                $.ajax({
                    url: API_PROXY + "https://api.douban.com/v2/book/search?q='养殖大户科学养猪系列'",
                    method: 'get',
                    dataType: 'json',
                    async: false,
                    success: res => {
                        console.log(res);
                        resolve(res)
                        arr1 = res
                    },
                    fail: function (a) {
                        console.log(a)
                    }
                })
            }
        ).then(
            res => {
                console.log(arr1)

            }
        ).catch(
            (e) => {
                console.log(e)
            }
        )


    })();
    //    (function () {
    //        var arr = [];
    //        $.ajax({
    //            type: "get",
    //            async: false, //同步执行//////////////////////!!!!!!!!!!!!!!!!!!上边没有是同步的问题
    //            url: API_PROXY + "https://api.douban.com/v2/book/search?q='养殖大户科学养猪系列'",
    //            data: {},
    //            dataType: "json", //返回数据形式为json
    //            success: function (result) {
    //                console.log(result)
    //                arr = result
    //
    //            },
    //            error: function (errorMsg) {
    ////                arr = [1, 2, 3]
    //            }
    //        })
    //        console.log(arr)
    //        return arr;
    //    })();
</script>
<script>
    function load_val(callback) {
        var arr1 = []
        $.ajax({
            url: API_PROXY + "https://api.douban.com/v2/book/search?q='养殖大户科学养猪系列'",
            method: 'get',
            dataType: 'json',
            success: res => {
                console.log(res);
                callback(res)
                arr1 = res
            },
            fail: function (a) {
                console.log(a)
            }
        })
    }
    load_val(function (data) {
        console.log(data);//这里可以得到值
    })
</script>
<script>
//    function load_val(callback){//定义一个回调函数
//        $.getJSON('test.php' , function(dat){
//            callback(data);//将返回结果当作参数返回
//        });
//    }
//
//    load_val(function(data){
//        alert(data);//这里可以得到值
//    });
//
//    //否则的话你需要这样用同步ajax来实现了
//
//    function load_val2(){
//        var result;
//        $.ajax({
//            dataType:'json',
//            url : 'test.php',
//            async:false,//这里选择异步为false，那么这个程序执行到这里的时候会暂停，等待
//                        //数据加载完成后才继续执行
//            success : function(data){
//                result = data;
//            }
//        });
//        return result;
//    }
//
//    var data = load_val();//这里可以直接拿到数据
</script>
</body>
</html>